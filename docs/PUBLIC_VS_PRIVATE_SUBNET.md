# ğŸŒ Public Subnet vs Private Subnet (VPC ë‚´ë¶€ ì—°ê²°)

**í•µì‹¬ ì§ˆë¬¸**: ìš°ë¦¬ ê³„íšì—ì„œëŠ” VPC ë‚´ë¶€ ì—°ê²°ì´ í•„ìš” ì—†ì–´? ê·¸ë˜ì„œ GHCR ê± ì¨ë„ ë˜ëŠ” ê±°ì•¼?

**ë‹µë³€**: ë§ìŠµë‹ˆë‹¤! ìš°ë¦¬ëŠ” **Public Subnetë§Œ ì‚¬ìš©**í•˜ë¯€ë¡œ GHCR ë°”ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤! âœ…

---

## ğŸ¯ ìš°ë¦¬ ê³„íš (Option 1: ê·¹ì´ˆê°„ë‹¨)

### í˜„ì¬ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Internet                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ ëª¨ë“  íŠ¸ë˜í”½ (HTTP, Docker pull)
                     â”‚
                     v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Internet Gateway (IGW)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                â”‚                â”‚
    v                v                v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ALB   â”‚    â”‚  App    â”‚    â”‚ MySQL   â”‚
â”‚ Public  â”‚    â”‚ Public  â”‚    â”‚ Public  â”‚
â”‚ Subnet  â”‚    â”‚ Subnet  â”‚    â”‚ Subnet  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ docker pull
                    â”‚ (ì¸í„°ë„· ì§ì ‘ ì ‘ê·¼!)
                    â”‚
                    v
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚     GHCR      â”‚
            â”‚ (GitHub ì„œë²„) â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Public Subnet â†’ IGW â†’ Internet â†’ GHCR
âœ… VPC Endpoint ë¶ˆí•„ìš”!
âœ… NAT Gateway ë¶ˆí•„ìš”!
âœ… GHCR ë°”ë¡œ ì ‘ê·¼ ê°€ëŠ¥!
```

### ë„¤íŠ¸ì›Œí¬ íë¦„

```
App Instanceê°€ Docker ì´ë¯¸ì§€ pull í•  ë•Œ:

1. docker pull ghcr.io/johnhuh619/simple-api:latest
   â†“
2. DNS ì¡°íšŒ: ghcr.io â†’ 140.82.112.x (GitHub IP)
   â†“
3. Public Subnet ë‚´ Instance (10.0.1.10)
   â†“
4. Internet Gateway (IGW)
   â†“
5. Internet
   â†“
6. GHCR (GitHub Container Registry)
   â†“
7. ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ! âœ…

ì†Œìš” ì‹œê°„: ~30ì´ˆ (500MB ì´ë¯¸ì§€ ê¸°ì¤€)
ë¹„ìš©: $0 (ì¸í„°ë„· ì†¡ì‹ ë§Œ, ìˆ˜ì‹ ì€ ë¬´ë£Œ!)
```

### ë³´ì•ˆ ì„¤ì •

```
ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ Public IPë¥¼ ê°€ì§€ë¯€ë¡œ:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Security Groupìœ¼ë¡œë§Œ ë³´í˜¸! â­             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ ALB (alb-sg):                           â”‚
â”‚   Inbound: 80 â† 0.0.0.0/0              â”‚
â”‚   Outbound: All                         â”‚
â”‚                                         â”‚
â”‚ App (app-sg):                           â”‚
â”‚   Inbound: 8080 â† alb-sgë§Œ! â­          â”‚
â”‚   Outbound: All (GHCR ì ‘ê·¼ ìœ„í•´)        â”‚
â”‚                                         â”‚
â”‚ MySQL (db-sg):                          â”‚
â”‚   Inbound: 3306 â† app-sgë§Œ! â­          â”‚
â”‚   Outbound: All                         â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í•µì‹¬:
  âœ… Appì€ ALBì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥ (í¬íŠ¸ 8080)
  âœ… MySQLì€ Appì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥ (í¬íŠ¸ 3306)
  âœ… ì™¸ë¶€ ì§ì ‘ ì ‘ê·¼ ì°¨ë‹¨ (Security Group)
  âš ï¸ í•˜ì§€ë§Œ Public IPëŠ” ì¡´ì¬ (ì¸í„°ë„· ë…¸ì¶œ)
```

---

## ğŸ¢ í”„ë¡œë•ì…˜ í™˜ê²½ (Private Subnet + VPC Endpoint)

### ë§Œì•½ Private Subnetì„ ì¼ë‹¤ë©´?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Internet                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Internet Gateway (IGW)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     v
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   ALB (Public) â”‚
            â”‚   Public Subnetâ”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ Forward traffic
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Private Subnet       â”‚
         â”‚                       â”‚
         v                       v
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   App   â”‚            â”‚  MySQL  â”‚
    â”‚ NO      â”‚            â”‚ NO      â”‚
    â”‚ Public  â”‚            â”‚ Public  â”‚
    â”‚ IP!     â”‚            â”‚ IP!     â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ docker pull í•˜ë ¤ë©´?
         â”‚ â†’ ì¸í„°ë„· ì ‘ê·¼ ë¶ˆê°€! âŒ
         â”‚
         â”‚ í•´ê²°ì±… 2ê°€ì§€:
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                               â”‚
    v                               v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NAT Gateway  â”‚            â”‚ VPC Endpoint â”‚
â”‚ (Publicì—    â”‚            â”‚ (ECR ì „ìš©)   â”‚
â”‚  ìœ„ì¹˜)       â”‚            â”‚              â”‚
â”‚              â”‚            â”‚              â”‚
â”‚ $32/ì›”! ğŸ’¸   â”‚            â”‚ $7/ì›”        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                           â”‚
       v                           v
   Internet                    AWS ECR
   â†’ GHCR                      (VPC ë‚´ë¶€!)
```

### Private Subnetì—ì„œ GHCR ì ‘ê·¼í•˜ë ¤ë©´?

```
ë°©ë²• 1: NAT Gateway ì‚¬ìš© â­ (ëª¨ë“  ì™¸ë¶€ ì ‘ê·¼)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Private Subnet (App)                        â”‚
â”‚   â†“ docker pull ghcr.io/...                â”‚
â”‚ Route Table: 0.0.0.0/0 â†’ NAT Gateway        â”‚
â”‚   â†“                                         â”‚
â”‚ NAT Gateway (Public Subnetì— ìœ„ì¹˜)          â”‚
â”‚   â†“                                         â”‚
â”‚ Internet Gateway                            â”‚
â”‚   â†“                                         â”‚
â”‚ Internet â†’ GHCR                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ë¹„ìš©:
  NAT Gateway: $0.045/ì‹œê°„ Ã— 24 Ã— 30 = $32.4/ì›”
  ë°ì´í„° ì „ì†¡: $0.045/GB (ì¶”ê°€ ë¹„ìš©!)
  â†’ 500MB ì´ë¯¸ì§€ 10ë²ˆ pull = $0.23

ì´: ~$33/ì›” ğŸ’¸ (ë¹„ìŒˆ!)

ì¥ì :
  âœ… ëª¨ë“  ì™¸ë¶€ ì„œë¹„ìŠ¤ ì ‘ê·¼ ê°€ëŠ¥ (GHCR, npm, apt-get ë“±)

ë‹¨ì :
  âš ï¸ ë¹„ìš© ë†’ìŒ
  âš ï¸ ì—¬ì „íˆ ì¸í„°ë„· ê²½ìœ  (ëŠë¦¼)
```

```
ë°©ë²• 2: VPC Endpoint + ECR ì‚¬ìš© â­â­ (ECR ì „ìš©)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Private Subnet (App)                        â”‚
â”‚   â†“ docker pull 123456.dkr.ecr.../app      â”‚
â”‚ Route Table: pl-xxxxx â†’ VPC Endpoint       â”‚
â”‚   â†“                                         â”‚
â”‚ VPC Endpoint (PrivateLink)                 â”‚
â”‚   â†“ (VPC ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬!)                    â”‚
â”‚ ECR (AWS ì„œë¹„ìŠ¤)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ë¹„ìš©:
  VPC Endpoint: $0.01/ì‹œê°„ Ã— 24 Ã— 30 = $7.2/ì›”
  ë°ì´í„° ì „ì†¡: $0 (ê°™ì€ ë¦¬ì „ ë‚´ ë¬´ë£Œ!)
  ECR ì €ì¥: $0.10/GB = $0.50/ì›” (5GB ê¸°ì¤€)

ì´: ~$8/ì›” (NATë³´ë‹¤ í›¨ì”¬ ì €ë ´!)

ì¥ì :
  âœ… ë¹ ë¦„ (AWS ë°±ë³¸ ë„¤íŠ¸ì›Œí¬)
  âœ… ì•ˆì „ (ì¸í„°ë„· ì•ˆ ê±°ì¹¨!)
  âœ… NAT ëŒ€ë¹„ ì €ë ´

ë‹¨ì :
  âš ï¸ ECRë§Œ ê°€ëŠ¥ (GHCR ì•ˆë¨! âŒ)
  âš ï¸ npm, apt-get ë“± ë‹¤ë¥¸ ì„œë¹„ìŠ¤ëŠ” NAT í•„ìš”
```

---

## ğŸ“Š ë¹„êµí‘œ: Public vs Private Subnet

| í•­ëª© | Public Subnet (ìš°ë¦¬) | Private Subnet (í”„ë¡œë•ì…˜) |
|------|---------------------|--------------------------|
| **Public IP** | âœ… ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ | âŒ ì—†ìŒ (ë” ì•ˆì „) |
| **ì¸í„°ë„· ì ‘ê·¼** | IGW ì§ì ‘ | NAT Gateway í•„ìš” |
| **Container Registry** | GHCR, ECR, Docker Hub ëª¨ë‘ ê°€ëŠ¥ | ECR + VPC Endpoint ê¶Œì¥ |
| **ë³´ì•ˆ** | Security Groupë§Œ | Security Group + ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬ |
| **ë¹„ìš© (5ì¼)** | ~$12 | ~$25 (NAT $5.4 + VPC Endpoint $1.2) |
| **ì„¤ì • ë‚œì´ë„** | â­â­â˜†â˜†â˜† | â­â­â­â­â˜† |
| **ì†ë„ (ì´ë¯¸ì§€ pull)** | ë³´í†µ (ì¸í„°ë„·) | ë¹ ë¦„ (VPC Endpoint) |
| **ì¶”ì²œ ëŒ€ìƒ** | ë°ëª¨, í•™ìŠµ, 5ì¼ ìš´ì˜ | í”„ë¡œë•ì…˜, ë³´ì•ˆ ì¤‘ìš” |

---

## ğŸ¯ ìš°ë¦¬ê°€ Public Subnet ì„ íƒí•œ ì´ìœ 

### ìš”êµ¬ì‚¬í•­ ì¬í™•ì¸

```
âœ… 5ì¼ê°„ë§Œ ìš´ì˜ (ë‹¨ê¸°)
âœ… êµ¬ì„± ë‚œì´ë„ ì‰½ê²Œ (ì´ˆê¸‰ì)
âœ… ë¹„ìš© ìµœì†Œí™”
âœ… ë¹ ë¥¸ êµ¬ì¶• (6-8ì‹œê°„)

â†’ Public Subnetì´ ìµœì !

ë§Œì•½ ì´ë¬ë‹¤ë©´ Private Subnet ì¼ì„ ê²ƒ:
  - ì¥ê¸° ìš´ì˜ (6ê°œì›”+)
  - ë³´ì•ˆ ì»´í”Œë¼ì´ì–¸ìŠ¤ í•„ìˆ˜
  - ë¯¼ê°í•œ ë°ì´í„° ì²˜ë¦¬
  - íšŒì‚¬ í”„ë¡œë•ì…˜ í™˜ê²½
```

### ë¹„ìš© ë¹„êµ (5ì¼ ê¸°ì¤€)

```
Public Subnet (ìš°ë¦¬):
  ALB: $2.70
  EC2 Ã— 2: $4.99
  MySQL EC2: $2.50
  EBS: $0.50
  GHCR: $0 âœ…
  NAT Gateway: $0 âœ…
  VPC Endpoint: $0 âœ…
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  ì´: ~$11

Private Subnet (í”„ë¡œë•ì…˜):
  ALB: $2.70
  EC2 Ã— 2: $4.99
  MySQL EC2: $2.50
  EBS: $0.50
  NAT Gateway: $5.40 ğŸ’¸
  VPC Endpoint: $1.20
  ECR: $0.50
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  ì´: ~$18

ì°¨ì´: $7 (64% ì¦ê°€!)
â†’ 5ì¼ë§Œ ì“°ëŠ”ë° êµ³ì´ Private Subnet?
```

---

## ğŸ” ë³´ì•ˆì€ ê´œì°®ì„ê¹Œ?

### Public Subnetì˜ ë³´ì•ˆ

```
âš ï¸ ì˜¤í•´: Public Subnet = ë³´ì•ˆ ì·¨ì•½?
âœ… ì‚¬ì‹¤: Security Groupìœ¼ë¡œ ì¶©ë¶„íˆ ì•ˆì „!

Public Subnetì—ì„œë„:
  âœ… Appì€ ALBì—ì„œë§Œ ì ‘ê·¼ (8080 â† alb-sg)
  âœ… MySQLì€ Appì—ì„œë§Œ ì ‘ê·¼ (3306 â† app-sg)
  âœ… SSHëŠ” My IPë§Œ í—ˆìš© ê°€ëŠ¥ (22 â† 1.2.3.4/32)
  âœ… ë‚˜ë¨¸ì§€ í¬íŠ¸ ì „ë¶€ ì°¨ë‹¨

Public IPê°€ ìˆì–´ë„:
  - 8080 í¬íŠ¸ëŠ” ALBì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥
  - 3306 í¬íŠ¸ëŠ” Appì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥
  - ëœë¤ í¬íŠ¸ ìŠ¤ìº” â†’ ì „ë¶€ ì°¨ë‹¨ë¨

â†’ 5ì¼ ë°ëª¨ì—ëŠ” ì¶©ë¶„íˆ ì•ˆì „! âœ…
```

### Private Subnetì´ ë” ì•ˆì „í•œ ì´ìœ 

```
Private Subnet ì¶”ê°€ ë³´ì•ˆ:
  âœ… Public IP ìì²´ê°€ ì—†ìŒ (ì™¸ë¶€ ì ‘ê·¼ ì›ì²œ ì°¨ë‹¨)
  âœ… ì¸í„°ë„· ë…¸ì¶œ ì œë¡œ (ë„¤íŠ¸ì›Œí¬ ë ˆë²¨ ê²©ë¦¬)
  âœ… VPC Flow Logs (ë„¤íŠ¸ì›Œí¬ ê°ì‚¬)
  âœ… AWS Security Hub í†µí•©

í•˜ì§€ë§Œ:
  âš ï¸ ë¹„ìš© ì¦ê°€ (NAT/VPC Endpoint)
  âš ï¸ ë³µì¡ë„ ì¦ê°€ (íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì–´ë ¤ì›€)
  âš ï¸ ì„¤ì • ì‹œê°„ ì¦ê°€ (2ë°°)

â†’ ì¥ê¸° í”„ë¡œë•ì…˜ì—ë§Œ ì¶”ì²œ!
```

---

## ğŸš€ ì‹¤ì œ ì˜ˆì‹œ: GHCR ì ‘ê·¼

### Public Subnet (ìš°ë¦¬ ê³„íš)

```bash
# EC2 Instance (Public Subnet) ë‚´ë¶€ì—ì„œ

$ docker pull ghcr.io/johnhuh619/simple-api:latest

latest: Pulling from johnhuh619/simple-api
e4fff0779e6d: Pull complete
3a0318fbb2b7: Pull complete
...
Status: Downloaded newer image for ghcr.io/johnhuh619/simple-api:latest
ghcr.io/johnhuh619/simple-api:latest

âœ… ë°”ë¡œ ì„±ê³µ! (30ì´ˆ ì†Œìš”)

ê²½ë¡œ:
  Instance (10.0.1.10)
    â†’ Route Table (0.0.0.0/0 â†’ IGW)
    â†’ Internet Gateway
    â†’ Internet
    â†’ GHCR (ghcr.io)
```

### Private Subnet (GHCR ì ‘ê·¼ ì‹œ)

```bash
# EC2 Instance (Private Subnet) ë‚´ë¶€ì—ì„œ

$ docker pull ghcr.io/johnhuh619/simple-api:latest

âŒ Error: dial tcp: lookup ghcr.io on 10.0.0.2:53: no route to host

ì´ìœ :
  - Private Subnet â†’ Public IP ì—†ìŒ
  - Route Table: 0.0.0.0/0 â†’ ??? (NAT ì—†ìŒ!)
  - ì¸í„°ë„· ì ‘ê·¼ ë¶ˆê°€

í•´ê²°ì±… 1: NAT Gateway ì¶”ê°€ ($32/ì›”)
  Route Table: 0.0.0.0/0 â†’ NAT Gateway

í•´ê²°ì±… 2: ECRë¡œ ì „í™˜ + VPC Endpoint ($8/ì›”)
  docker pull 123456.dkr.ecr.ap-northeast-2.amazonaws.com/...
```

---

## ğŸ’¡ í”„ë¡œë•ì…˜ ì „í™˜ ì‹œë‚˜ë¦¬ì˜¤

### Phase 1: Public Subnet (í˜„ì¬)

```
ëª©ì : ë¹ ë¥¸ ë°ëª¨, í•™ìŠµ
ê¸°ê°„: 5ì¼
ë¹„ìš©: $11
ë³´ì•ˆ: Security Group
GHCR: âœ… ë°”ë¡œ ì ‘ê·¼
```

### Phase 2: Public Subnet + ECR (ì¤‘ê°„)

```
ëª©ì : í”„ë¡œë•ì…˜ ì¤€ë¹„
ê¸°ê°„: 1-3ê°œì›”
ë¹„ìš©: $20 (ECR $10 ì¶”ê°€)
ë³´ì•ˆ: Security Group
ECR: âœ… AWS í†µí•©

ë³€ê²½:
  - GHCR â†’ ECR ë§ˆì´ê·¸ë ˆì´ì…˜ (1ì‹œê°„)
  - ë‚˜ë¨¸ì§€ ë™ì¼
```

### Phase 3: Private Subnet + ECR + VPC Endpoint (ì™„ì „ì²´)

```
ëª©ì : ì¥ê¸° í”„ë¡œë•ì…˜
ê¸°ê°„: 6ê°œì›”+
ë¹„ìš©: $150/ì›” (NAT/VPC Endpoint í¬í•¨)
ë³´ì•ˆ: Network ê²©ë¦¬ + Security Group
ECR: âœ… VPC Endpoint (ë¹ ë¦„!)

ë³€ê²½:
  - Private Subnet ì¶”ê°€
  - NAT Gateway ë˜ëŠ” VPC Endpoint êµ¬ì„±
  - NACL (Network ACL) ì¶”ê°€
  - VPC Flow Logs í™œì„±í™”
  - ì„¤ì • ì‹œê°„: +5ì‹œê°„
```

---

## ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸: ì–¸ì œ Private Subnet?

```
Public Subnetìœ¼ë¡œ ì¶©ë¶„í•œ ê²½ìš°:
â–¡ 5ì¼ ì´í•˜ ë°ëª¨/í…ŒìŠ¤íŠ¸
â–¡ í•™ìŠµ ëª©ì 
â–¡ ë¹„ìš© ìµœì†Œí™” í•„ìš”
â–¡ ë¹ ë¥¸ êµ¬ì¶• í•„ìš” (6-8ì‹œê°„)
â–¡ ì´ˆê¸‰ì (ë„¤íŠ¸ì›Œí¬ ì§€ì‹ ì ìŒ)
â–¡ ë¯¼ê°í•œ ë°ì´í„° ì—†ìŒ

Private Subnet í•„ìš”í•œ ê²½ìš°:
â–¡ 6ê°œì›” ì´ìƒ í”„ë¡œë•ì…˜
â–¡ ë³´ì•ˆ ì»´í”Œë¼ì´ì–¸ìŠ¤ í•„ìˆ˜ (ISO, SOC2)
â–¡ ê¸ˆìœµ/ì˜ë£Œ ë°ì´í„°
â–¡ íšŒì‚¬ ë³´ì•ˆ ì •ì±… (Public IP ê¸ˆì§€)
â–¡ PCI-DSS ì¤€ìˆ˜ í•„ìš”
â–¡ ë„¤íŠ¸ì›Œí¬ ê°ì‚¬ í•„ìš” (VPC Flow Logs)
```

---

## ğŸ“ í•µì‹¬ ì •ë¦¬

### Q1: ìš°ë¦¬ ê³„íšì—ì„œëŠ” VPC ë‚´ë¶€ ì—°ê²°ì´ í•„ìš” ì—†ì–´?

```
A: ë§ìŠµë‹ˆë‹¤!

ìš°ë¦¬ëŠ” Public Subnet ì‚¬ìš©
  â†’ Internet Gatewayë¡œ ë°”ë¡œ ì¸í„°ë„· ì ‘ê·¼
  â†’ VPC Endpoint ë¶ˆí•„ìš”
  â†’ NAT Gateway ë¶ˆí•„ìš”
  â†’ GHCR ë°”ë¡œ pull ê°€ëŠ¥! âœ…
```

### Q2: ê·¸ë˜ì„œ GHCR ê± ì¨ë„ ë˜ëŠ” ê±°ì•¼?

```
A: ë„¤, ì™„ì „ ë©ë‹ˆë‹¤!

Public Subnetì´ë¼ì„œ:
  âœ… GHCR ë°”ë¡œ ì ‘ê·¼ ê°€ëŠ¥
  âœ… Docker Hub, npm, apt-get ë‹¤ ê°€ëŠ¥
  âœ… ì¶”ê°€ ë¹„ìš© ì—†ìŒ ($0)
  âœ… ì„¤ì • ê°„ë‹¨

Private Subnetì´ì—ˆë‹¤ë©´:
  âš ï¸ NAT Gateway í•„ìš” ($32/ì›”)
  âš ï¸ ë˜ëŠ” ECR + VPC Endpoint ($8/ì›”)
  âš ï¸ GHCRì€ NAT í†µí•´ì•¼ë§Œ ì ‘ê·¼
```

### Q3: ë³´ì•ˆì€ ê´œì°®ì•„?

```
A: 5ì¼ ë°ëª¨ì—ëŠ” ì¶©ë¶„í•©ë‹ˆë‹¤!

Security Groupìœ¼ë¡œ:
  âœ… Appì€ ALBì—ì„œë§Œ ì ‘ê·¼
  âœ… MySQLì€ Appì—ì„œë§Œ ì ‘ê·¼
  âœ… ì™¸ë¶€ ì§ì ‘ ì ‘ê·¼ ì°¨ë‹¨

í•˜ì§€ë§Œ ì¥ê¸° í”„ë¡œë•ì…˜ì´ë©´:
  â†’ Private Subnet + ECR ê¶Œì¥
  â†’ ë„¤íŠ¸ì›Œí¬ ë ˆë²¨ ê²©ë¦¬ ì¶”ê°€
```

---

## ğŸ¯ ìµœì¢… ê²°ë¡ 

```
ìš°ë¦¬ ê³„íš (Public Subnet):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… GHCR ë°”ë¡œ ì ‘ê·¼ ê°€ëŠ¥!              â”‚
â”‚ âœ… VPC ë‚´ë¶€ ì—°ê²° ë¶ˆí•„ìš”              â”‚
â”‚ âœ… NAT Gateway ë¶ˆí•„ìš” ($32 ì ˆì•½!)   â”‚
â”‚ âœ… VPC Endpoint ë¶ˆí•„ìš” ($7 ì ˆì•½!)   â”‚
â”‚ âœ… ë¹„ìš©: $11 (5ì¼)                   â”‚
â”‚ âœ… ì„¤ì •: 6-8ì‹œê°„                     â”‚
â”‚ âœ… ë³´ì•ˆ: Security Groupìœ¼ë¡œ ì¶©ë¶„    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í”„ë¡œë•ì…˜ (Private Subnet):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ GHCR ì ‘ê·¼ ìœ„í•´ NAT í•„ìš”          â”‚
â”‚ âš ï¸ ë˜ëŠ” ECR + VPC Endpoint          â”‚
â”‚ ğŸ’¸ ë¹„ìš©: $150/ì›”                     â”‚
â”‚ ğŸ• ì„¤ì •: 12-15ì‹œê°„                   â”‚
â”‚ ğŸ”’ ë³´ì•ˆ: ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬ + SG         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë‹µë³€**: ë„¤, ìš°ë¦¬ ê³„íšì€ Public Subnetì´ë¼ GHCR ë°”ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤!
VPC ë‚´ë¶€ ì—°ê²° (VPC Endpoint) ë¶ˆí•„ìš”í•˜ê³ , ê·¸ë˜ì„œ GHCR ì¨ë„ ì™„ì „ OKì…ë‹ˆë‹¤! âœ…

**5ì¼ ë°ëª¨ì—ëŠ” ì´ê²Œ ìµœì ì…ë‹ˆë‹¤.** í”„ë¡œë•ì…˜ ì „í™˜í•  ë•Œë§Œ Private Subnet + ECR ê³ ë ¤í•˜ë©´ ë©ë‹ˆë‹¤! ğŸš€
